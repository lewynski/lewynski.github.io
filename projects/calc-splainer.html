<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculator Splainer - Project</title>
    <link rel="stylesheet" href="../style.css">
    <style>
        /* --- Split View Styles --- */
        body { background-color: #ffffff; } 
        
        .split-container {
            display: flex;
            gap: 20px;
            height: 850px; /* Default height for Desktop */
            margin-top: 30px;
            margin-bottom: 50px;
        }

        /* LEFT SIDE: The Code Snippet */
        .code-view {
            flex: 1;
            background: #1e1e1e; /* VS Code Dark Theme */
            color: #d4d4d4;
            padding: 20px;
            border-radius: 12px;
            overflow: auto;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.85rem;
            border: 1px solid #333;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.5);
        }

        /* Syntax Highlighting Colors */
        .k { color: #569cd6; } /* Keyword */
        .f { color: #dcdcaa; } /* Function */
        .s { color: #ce9178; } /* String */
        .c { color: #6a9955; } /* Comment */
        .n { color: #b5cea8; } /* Number */

        /* RIGHT SIDE: The Live App */
        .output-view {
            flex: 1;
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid #e5e7eb;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            background: white;
        }

        /* The Iframe that loads your calc.html */
        iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        /* --- MOBILE RESPONSIVE FIX --- */
        @media (max-width: 900px) {
            .split-container {
                /* FIX: 'column' puts the first item (Code) on TOP */
                flex-direction: column; 
                height: auto;
            }

            .code-view { 
                height: 400px; 
                margin-bottom: 30px; /* Adds space between Code and Calculator */
            }

            .output-view { 
                /* Tall enough for the calculator + story box */
                height: 800px; 
            }
        }
    </style>
</head>
<body>

    <nav>
        <div class="logo">LEITUSXNM</div>
        <div class="nav-links">
            <a href="../index.html">Home</a>
            <a href="https://github.com/leitusxnm" target="_blank">GitHub</a>
            <a href="https://discord.com/users/879936602414133288" target="_blank">Discord</a>
            
            <div class="dropdown">
                <button class="dropbtn">Projects â–¾</button>
                <div class="dropdown-content">
                    <a href="calc-splainer.html">Calculator Splainer</a>
                    <a href="determinants.html">Determinant Calc</a>
                    <a href="crout.html">Crout Solver</a>
                </div>
            </div>
        </div>
    </nav>

    <div class="container" style="display: block; max-width: 1200px;">
        
        <div style="text-align: center; margin-bottom: 40px;">
            <h1 style="font-size: 2.5rem; color: #111827;">Storytelling Calculator</h1>
            <p style="color: #6b7280;">A whimsical calculator that narrates the result using AI logic.</p>
            <div style="margin-top: 15px;">
                <span style="background:#e0e7ff; color:#4338ca; padding:5px 10px; border-radius:15px; font-size:0.8rem; font-weight:bold;">JavaScript</span>
                <span style="background:#d1fae5; color:#065f46; padding:5px 10px; border-radius:15px; font-size:0.8rem; font-weight:bold; margin-left:5px;">Tailwind CSS</span>
                <span style="background:#fce7f3; color:#9d174d; padding:5px 10px; border-radius:15px; font-size:0.8rem; font-weight:bold; margin-left:5px;">Gemini API</span>
            </div>
        </div>

        <div class="split-container">
            
            <div class="code-view">
<pre>
<span class="c">// --- The Logic Behind the Story ---</span>

<span class="k">async function</span> <span class="f">showStory</span>() {
    <span class="k">if</span> (!lastCalculation) <span class="k">return</span>;

    <span class="c">// 1. Disable UI while thinking</span>
    storyButton.disabled = <span class="k">true</span>;
    storyBox.classList.<span class="f">remove</span>(<span class="s">'hidden'</span>);
    
    <span class="k">try</span> {
        <span class="c">// 2. Call the AI Generation function</span>
        <span class="k">const</span> story = <span class="k">await</span> <span class="f">generateStory</span>(
            lastCalculation.num1, 
            lastCalculation.op, 
            lastCalculation.num2, 
            lastCalculation.res
        );

        <span class="c">// 3. Typewriter Effect (Word by Word)</span>
        <span class="k">const</span> words = story.<span class="f">split</span>(<span class="s">' '</span>);
        <span class="k">const</span> delay = <span class="n">150</span>; 

        <span class="k">for</span> (<span class="k">const</span> word <span class="k">of</span> words) {
            storyText.textContent += word + <span class="s">' '</span>;
            <span class="k">await</span> <span class="k">new</span> <span class="f">Promise</span>(r => <span class="f">setTimeout</span>(r, delay));
        }

    } <span class="k">catch</span> (error) {
        console.<span class="f">error</span>(<span class="s">'Story generation failed'</span>);
    }
}

<span class="c">// --- API Integration ---</span>
<span class="k">const</span> systemPrompt = 
  <span class="s">"You are a whimsical storyteller. Explain the math result in a magical way."</span>;
</pre>
            </div>

            <div class="output-view">
                <iframe src="calc.html?v=2"></iframe>
            </div>

        </div>
    </div>

</body>
</html>
