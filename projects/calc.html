<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Storytelling Calculator</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; background-color: #111827; }
    .card { background: #1F2937; border: 1px solid #374151; }
    .result-screen { font-family: 'Playfair Display', serif; min-height: 80px; overflow-wrap: break-word; }
    .btn-operator:hover, .btn-story:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3); }
    .spinner { border: 3px solid rgba(255,255,255,0.2); border-left-color: #4f46e5; border-radius: 50%; width: 20px; height: 20px; animation: spin 1s linear infinite; }
    @keyframes spin { to { transform: rotate(360deg); } }
    /* Mobile scrolling fix */
    ::-webkit-scrollbar { width: 0px; background: transparent; }
  </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen text-white p-2">

  <div class="card w-full max-w-md mx-auto rounded-2xl p-5 shadow-2xl flex flex-col gap-4">
    
    <div>
        <h1 class="text-2xl font-bold text-center text-indigo-400">Storytelling Calculator</h1>
        <p class="text-center text-gray-400 text-sm">Where numbers come to life.</p>
    </div>

    <div id="result-screen" class="result-screen bg-gray-900 rounded-lg p-4 text-center flex items-center justify-center border border-gray-700">
      <p id="result-text" class="text-gray-300 text-lg">0</p>
    </div>

    <div class="grid grid-cols-2 gap-3">
      <input type="text" inputmode="numeric" id="num1" placeholder="Num 1" class="bg-gray-700 border border-gray-600 rounded-lg p-3 text-center focus:ring-2 focus:ring-indigo-500 outline-none">
      <input type="text" inputmode="numeric" id="num2" placeholder="Num 2" class="bg-gray-700 border border-gray-600 rounded-lg p-3 text-center focus:ring-2 focus:ring-indigo-500 outline-none">
    </div>

    <div class="grid grid-cols-4 gap-3">
      <button onclick="performCalculation('+')" class="btn-operator bg-indigo-600 p-3 rounded-lg text-xl font-bold shadow-lg">+</button>
      <button onclick="performCalculation('-')" class="btn-operator bg-indigo-600 p-3 rounded-lg text-xl font-bold shadow-lg">−</button>
      <button onclick="performCalculation('*')" class="btn-operator bg-indigo-600 p-3 rounded-lg text-xl font-bold shadow-lg">×</button>
      <button onclick="performCalculation('/')" class="btn-operator bg-indigo-600 p-3 rounded-lg text-xl font-bold shadow-lg">÷</button>
    </div>
    
    <button id="story-button" disabled onclick="showStory()" class="btn-story w-full bg-teal-600 hover:bg-teal-500 p-3 rounded-lg text-lg font-bold shadow-lg disabled:opacity-50 disabled:cursor-not-allowed transition">
      ✨ Tell me a Story
    </button>
    
    <p id="error-message" class="text-red-400 text-center text-sm h-4"></p>

    <div id="story-box" class="hidden mt-2 border-t border-gray-700 pt-4">
        <h2 class="text-lg font-bold text-center mb-2 text-teal-400">The Story of the Numbers</h2>
        <div class="bg-gray-900 rounded-lg p-4 border border-gray-700 min-h-[100px] flex items-center justify-center">
            <p id="story-text" class="text-gray-300 text-base leading-relaxed text-center"></p>
            <div id="story-loader" class="spinner hidden"></div>
        </div>
    </div>

  </div>

  <script>
    /* Javascript logic (Same as before, just kept compact) */
    const resultText = document.getElementById('result-text');
    const errorMessage = document.getElementById('error-message');
    const storyButton = document.getElementById('story-button');
    const storyBox = document.getElementById('story-box');
    const storyText = document.getElementById('story-text');
    const storyLoader = document.getElementById('story-loader');
    
    let lastCalculation = null;

    function performCalculation(operator) {
      const num1Input = document.getElementById('num1');
      const num2Input = document.getElementById('num2');
      errorMessage.textContent = '';
      storyButton.disabled = true; 
      storyBox.classList.add('hidden'); 
      
      let num1, num2;
      try {
        if (!/^-?\d+$/.test(num1Input.value) || !/^-?\d+$/.test(num2Input.value)) throw new Error();
        num1 = BigInt(num1Input.value); num2 = BigInt(num2Input.value);
      } catch (e) { errorMessage.textContent = 'Enter whole numbers.'; return; }

      let result, symbol = operator;
      if (operator === '+') result = num1 + num2;
      if (operator === '-') result = num1 - num2;
      if (operator === '*') { result = num1 * num2; symbol = '×'; }
      if (operator === '/') { if(num2===0n){errorMessage.textContent='No zero division';return;} result = num1/num2; symbol = '÷'; }

      resultText.innerHTML = `<span class="text-2xl text-indigo-300">${num1} ${symbol} ${num2} = ${result}</span>`;
      lastCalculation = { num1: num1.toString(), op: symbol, num2: num2.toString(), res: result.toString() };
      storyButton.disabled = false;
    }
    
    async function showStory() {
        if (!lastCalculation) return;
        storyButton.disabled = true;
        storyBox.classList.remove('hidden');
        storyText.classList.add('hidden');
        storyLoader.classList.remove('hidden');
        storyText.textContent = '';
        
        try {
            const story = await generateStory(lastCalculation.num1, lastCalculation.op, lastCalculation.num2, lastCalculation.res);
            const words = story.split(' ');
            storyLoader.classList.add('hidden');
            storyText.classList.remove('hidden');
            for (const word of words) {
                storyText.textContent += word + ' ';
                await new Promise(r => setTimeout(r, 100));
            }
        } catch (e) { storyText.textContent = 'Magic failed today.'; storyLoader.classList.add('hidden'); storyText.classList.remove('hidden'); }
        storyButton.disabled = false;
    }

    async function generateStory(num1, op, num2, res) {
      /* SAME AI LOGIC AS YOUR ORIGINAL CODE */
      const stories = [
        (a,o,b,r) => `The numbers ${a} and ${b} met under a ${o} sign. Together, they became the legendary ${r}.`,
        (a,o,b,r) => `${a} challenged ${b} to a duel of ${o}. The dust settled, revealing ${r}.`,
        (a,o,b,r) => `Once, ${a} and ${b} combined their powers using ${o} to summon ${r}.`
      ];
      // Simulate API delay for demo
      await new Promise(r => setTimeout(r, 1000));
      return stories[Math.floor(Math.random()*stories.length)](num1,op,num2,res);
    }
  </script>
</body>
</html>
