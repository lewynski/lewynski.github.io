<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Jon's Journey - Interactive Resume</title>

    <script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body {
            background-color: #ffffff;
            font-family: 'Inter', sans-serif;
            color: #111827;
            padding: 40px;
            min-height: 100vh;
        }

        .page-header { margin-bottom: 30px; }
        .page-header h1 { font-size: 1.8rem; font-weight: 700; margin-bottom: 8px; }
        .page-header p { color: #6b7280; font-size: 0.95rem; }
        
        .back-btn {
            display: inline-block; margin-bottom: 20px;
            color: #4b5563; text-decoration: none; font-weight: 500;
            background: #f3f4f6; padding: 8px 16px; border-radius: 8px;
            transition: background 0.2s;
        }
        .back-btn:hover { background: #e5e7eb; color: #111827; }

        .layout-container { display: flex; gap: 24px; max-width: 1300px; margin: 0 auto; }
        .left-column { width: 320px; display: flex; flex-direction: column; gap: 20px; flex-shrink: 0; }

        .panel {
            background: #ffffff; border: 1px solid #e5e7eb;
            border-radius: 12px; padding: 24px;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05);
        }

        .panel h3 { font-size: 0.75rem; color: #9ca3af; letter-spacing: 1px; margin-bottom: 16px; text-transform: uppercase; }

        .keyboard-layout { display: flex; flex-direction: column; align-items: center; gap: 6px; margin-bottom: 16px; }
        .key-row { display: flex; gap: 6px; }
        .key {
            width: 40px; height: 40px; background: #ffffff; border: 1px solid #e5e7eb;
            border-radius: 8px; display: flex; justify-content: center; align-items: center;
            font-weight: 600; color: #374151; box-shadow: 0 2px 0 #e5e7eb;
        }
        .instruction-text { text-align: center; color: #6b7280; font-size: 0.85rem; line-height: 1.5; }

        .right-column { flex: 1; position: relative; }

        #game-wrapper {
            width: 100%; height: 650px; background: #f8fafc;
            border: 1px solid #e5e7eb; border-radius: 16px;
            overflow: hidden; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.05);
            position: relative;
        }

        #dialogue-overlay {
            position: absolute; bottom: 24px; left: 50%; transform: translateX(-50%);
            width: 90%; max-width: 450px; background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px);
            border: 1px solid #e5e7eb; border-radius: 12px; padding: 24px; display: none; 
            box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1), 0 8px 10px -6px rgba(0,0,0,0.1); z-index: 10;
        }
        
        #dialogue-title { font-size: 1.1rem; font-weight: 700; color: #111827; margin-bottom: 8px; }
        #dialogue-text { font-size: 0.95rem; line-height: 1.6; color: #4b5563; }
        #dialogue-text strong { color: #111827; font-weight: 600; }

        #close-dialogue {
            margin-top: 16px; background: #f1f5f9; border: 1px solid #e2e8f0; color: #475569;
            padding: 8px 16px; border-radius: 6px; cursor: pointer; font-weight: 600; width: 100%; transition: all 0.2s;
        }
        #close-dialogue:hover { background: #e2e8f0; color: #1e293b; }

        #mobile-controls {
            position: absolute; bottom: 20px; left: 20px; display: none; z-index: 5;
        }
        .d-pad { display: grid; grid-template-columns: repeat(3, 50px); grid-template-rows: repeat(3, 50px); gap: 6px; }
        .ctrl-btn {
            background: #ffffff; border: 1px solid #e5e7eb; border-radius: 12px; 
            color: #4b5563; font-size: 20px; display: flex; justify-content: center; align-items: center; user-select: none;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1);
        }
        .ctrl-btn:active { background: #e5e7eb; color: #111827; }
        #btn-up { grid-column: 2; grid-row: 1; }
        #btn-left { grid-column: 1; grid-row: 2; }
        #btn-right { grid-column: 3; grid-row: 2; }
        #btn-down { grid-column: 2; grid-row: 3; }

        @media (max-width: 900px) {
            .layout-container { flex-direction: column; }
            .left-column { width: 100%; }
            body { padding: 20px; }
        }
    </style>
</head>
<body>

    <a href="index.html" class="back-btn">‚Üê Exit Community</a>

    <div class="page-header">
        <h1>Welcome to Jon's Community</h1>
        <p>A minimalist interactive space to explore my background.</p>
    </div>

    <div class="layout-container">
        <div class="left-column">
            <div class="panel">
                <h3>Chat Log</h3>
                <div style="background: #f8fafc; padding: 12px; border: 1px solid #e2e8f0; border-radius: 8px; font-size: 0.85rem; color: #475569; margin-bottom: 12px;">
                    <span style="color: #3b82f6; font-weight: 600;">Server:</span> Welcome! The game is now active.
                </div>
                <div style="background: #eff6ff; border: 1px solid #bfdbfe; color: #1e3a8a; padding: 12px; border-radius: 8px; font-size: 0.85rem; align-self: flex-end;">
                    <strong>Tip:</strong> You can now use WASD to walk, no clicking required!
                </div>
            </div>

            <div class="panel hidden-on-mobile" id="pc-instructions">
                <h3>Instructions</h3>
                <div class="keyboard-layout">
                    <div class="key-row"><div class="key">W</div></div>
                    <div class="key-row"><div class="key">A</div><div class="key">S</div><div class="key">D</div></div>
                </div>
                <p class="instruction-text">Hold <strong>WASD</strong> or Arrow keys to walk.<br>Step on the desks to read details.</p>
            </div>
        </div>

        <div class="right-column">
            <div id="game-wrapper">
                
                <div id="dialogue-overlay">
                    <div id="dialogue-title">Building Name</div>
                    <div id="dialogue-text">Details go here...</div>
                    <button id="close-dialogue">Close</button>
                </div>

                <div id="mobile-controls">
                    <div class="d-pad">
                        <div class="ctrl-btn" id="btn-up"><i class="fas fa-chevron-up"></i></div>
                        <div class="ctrl-btn" id="btn-left"><i class="fas fa-chevron-left"></i></div>
                        <div class="ctrl-btn" id="btn-right"><i class="fas fa-chevron-right"></i></div>
                        <div class="ctrl-btn" id="btn-down"><i class="fas fa-chevron-down"></i></div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script>
        // --- NATIVE KEYBOARD OVERRIDE (BULLETPROOF) ---
        let activeKeys = { up: false, down: false, left: false, right: false };
        
        window.addEventListener('keydown', (e) => {
            const k = e.key.toLowerCase();
            // Prevent scrolling when pressing arrow keys
            if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].indexOf(e.code) > -1) { e.preventDefault(); }
            
            if (k === 'w' || e.code === 'ArrowUp') activeKeys.up = true;
            if (k === 'a' || e.code === 'ArrowLeft') activeKeys.left = true;
            if (k === 's' || e.code === 'ArrowDown') activeKeys.down = true;
            if (k === 'd' || e.code === 'ArrowRight') activeKeys.right = true;
        });

        window.addEventListener('keyup', (e) => {
            const k = e.key.toLowerCase();
            if (k === 'w' || e.code === 'ArrowUp') activeKeys.up = false;
            if (k === 'a' || e.code === 'ArrowLeft') activeKeys.left = false;
            if (k === 's' || e.code === 'ArrowDown') activeKeys.down = false;
            if (k === 'd' || e.code === 'ArrowRight') activeKeys.right = false;
        });

        // ----------------------------------------------

        const WORLD_WIDTH = 1600;
        const WORLD_HEIGHT = 1200;

        const resumeData = [
            { id: 'elem', x: 300, y: 1000, title: "Primary Education", text: "<strong>Jose G. Peralta Memorial School</strong><br>Valedictorian (2011-2017)" },
            { id: 'jhs', x: 300, y: 800, title: "Junior High School", text: "<strong>Fellowship Baptist College</strong><br>With Honor (2017-2021)" },
            { id: 'shs', x: 300, y: 600, title: "Senior High (STEM)", text: "<strong>Fellowship Baptist College</strong><br>With High Honor (2021-2023)" },
            { id: 'college', x: 300, y: 400, title: "PUP College", text: "<strong>B.S. Electronics Engineering</strong><br>Affiliations: OECES, IECEP Batangas." },
            { id: 'work', x: 800, y: 600, title: "Work Experience", text: "<strong>Bandai Wireharness (2025):</strong> Developed automated macro systems.<br><br><strong>NOCECO (2023):</strong> Assisted in daily technical operations." },
            { id: 'skill_prog', x: 1300, y: 1000, title: "Programming", text: "<strong>Languages:</strong> Python, JavaScript, HTML/CSS, Java, C++<br><em>Building robust logic and full-stack applications.</em>" },
            { id: 'skill_hw', x: 1300, y: 800, title: "Embedded Sys", text: "<strong>Hardware:</strong> Arduino, FPGA, TinkerCAD, Proto Boarding<br><em>Bridging the gap between software and circuitry.</em>" },
            { id: 'skill_sim', x: 1300, y: 600, title: "Simulation", text: "<strong>Software:</strong> AutoCAD, MATLAB, Multisim, Proteus<br><em>Modeling complex systems and blueprints.</em>" },
            { id: 'proj_calc', x: 900, y: 200, title: "Eng. Tools", text: "<strong>Projects:</strong> Calc Splainer, Determinant Calculator, Matrix Operations.<br><em>Custom software built to solve math problems.</em>" },
            { id: 'proj_game', x: 1100, y: 200, title: "Games", text: "<strong>Projects:</strong> Cyber Viper, Neon Flap, Minimax AI Tic-Tac-Toe, Neon 2048.<br><em>Game development testing complex logic.</em>" },
            { id: 'proj_ai', x: 1300, y: 200, title: "Eiji AI", text: "<strong>Project:</strong> Eiji / D Dwarf Mini.<br><em>A sleek conversational assistant powered by Groq LPUs.</em>" }
        ];

        const config = {
            type: Phaser.AUTO,
            scale: { mode: Phaser.Scale.FIT, parent: 'game-wrapper', width: 800, height: 600 },
            backgroundColor: '#f8fafc',
            physics: { default: 'arcade', arcade: { gravity: { y: 0 }, debug: false } },
            scene: { create: create, update: update }
        };

        const game = new Phaser.Game(config);

        let player, playerLabel;
        let moveSpeed = 220; 
        let isDialogueOpen = false;

        function create() {
            this.physics.world.setBounds(0, 0, WORLD_WIDTH, WORLD_HEIGHT);

            let graphics = this.add.graphics();
            graphics.fillStyle(0xcbd5e1, 1);
            for(let i = 0; i < WORLD_WIDTH; i += 40) {
                for(let j = 0; j < WORLD_HEIGHT; j += 40) {
                    graphics.fillPoint(i, j, 2);
                }
            }

            const stations = this.physics.add.staticGroup();

            function createDesk(scene, x, y, title) {
                scene.add.rectangle(x, y + 8, 70, 40, 0x000000, 0.05);
                let desk = scene.add.rectangle(x, y, 70, 40, 0xffffff);
                desk.setStrokeStyle(2, 0xcbd5e1);
                scene.add.rectangle(x, y - 8, 40, 12, 0xe2e8f0);
                scene.add.text(x, y + 30, title, { fontFamily: 'Inter', fontSize: '12px', fill: '#475569', fontStyle: '600' }).setOrigin(0.5);
                return desk;
            }

            function createDottedZone(scene, x, y, width, height, title) {
                let fill = scene.add.rectangle(x, y, width, height, 0xf1f5f9, 0.6);
                fill.setStrokeStyle(2, 0x94a3b8);
                scene.add.text(x, y - 20, title, { fontFamily: 'Inter', fontSize: '15px', fill: '#1e293b', fontStyle: '700' }).setOrigin(0.5);
                scene.add.text(x, y + 10, "CodeCred.dev", { fontFamily: 'Inter', fontSize: '11px', fill: '#64748b' }).setOrigin(0.5);
                return fill;
            }

            resumeData.forEach(data => {
                if(data.id === 'work') {
                    createDottedZone(this, data.x, data.y, 220, 120, data.title);
                    createTrigger(this, data.x, data.y, 220, 120, data);
                } else {
                    createDesk(this, data.x, data.y, data.title);
                    createTrigger(this, data.x, data.y, 70, 40, data);
                }
            });

            player = this.add.rectangle(800, 1000, 24, 24, 0x3b82f6);
            this.physics.add.existing(player);
            player.body.setCollideWorldBounds(true);
            
            playerLabel = this.add.text(800, 1030, "Jon Lewyn", { 
                fontFamily: 'Inter', fontSize: '12px', fill: '#3b82f6', fontStyle: '700',
            }).setOrigin(0.5);

            this.cameras.main.startFollow(player, true, 0.1, 0.1);
            this.cameras.main.setBounds(0, 0, WORLD_WIDTH, WORLD_HEIGHT);

            setupMobileControls();

            let closeBtn = document.getElementById('close-dialogue');
            if(closeBtn) { closeBtn.addEventListener('click', closeDialogue); }
        }

        function update() {
            playerLabel.x = player.x;
            playerLabel.y = player.y + 25;

            if (isDialogueOpen) {
                player.body.setVelocity(0);
                return;
            }

            let velX = 0;
            let velY = 0;

            // Using our new bulletproof Native Keys!
            if (activeKeys.left) velX = -moveSpeed;
            else if (activeKeys.right) velX = moveSpeed;

            if (activeKeys.up) velY = -moveSpeed;
            else if (activeKeys.down) velY = moveSpeed;

            player.body.setVelocity(velX, velY);

            if (velX !== 0 && velY !== 0) {
                player.body.velocity.normalize().scale(moveSpeed);
            }
        }

        function createTrigger(scene, x, y, width, height, data) {
            let pad = scene.add.rectangle(x, y, width + 20, height + 20, 0x000000, 0); 
            scene.physics.add.existing(pad, true); 

            scene.physics.add.overlap(player, pad, () => {
                if (!isDialogueOpen) { showDialogue(data.title, data.text); }
            });
        }

        function showDialogue(title, text) {
            isDialogueOpen = true;
            activeKeys.up = false; activeKeys.down = false; activeKeys.left = false; activeKeys.right = false; // Reset keys
            const overlay = document.getElementById('dialogue-overlay');
            if(overlay) {
                document.getElementById('dialogue-title').innerHTML = title;
                document.getElementById('dialogue-text').innerHTML = text;
                overlay.style.display = 'block';
            }
        }

        function closeDialogue() {
            const overlay = document.getElementById('dialogue-overlay');
            if(overlay) overlay.style.display = 'none';
            player.y += 15; 
            setTimeout(() => { isDialogueOpen = false; }, 200);
        }

        function setupMobileControls() {
            if ('ontouchstart' in window || navigator.maxTouchPoints > 0) {
                let mobileContainer = document.getElementById('mobile-controls');
                if(mobileContainer) mobileContainer.style.display = 'block';
                const pcInstructions = document.getElementById('pc-instructions');
                if (pcInstructions) pcInstructions.style.display = 'none';
            }

            const setupBtn = (id, direction) => {
                const btn = document.getElementById(id);
                if (!btn) return; 
                const press = (e) => { e.preventDefault(); activeKeys[direction] = true; };
                const release = (e) => { e.preventDefault(); activeKeys[direction] = false; };
                
                btn.addEventListener('touchstart', press);
                btn.addEventListener('mousedown', press);
                btn.addEventListener('touchend', release);
                btn.addEventListener('mouseup', release);
                btn.addEventListener('mouseleave', release);
            };

            setupBtn('btn-up', 'up');
            setupBtn('btn-down', 'down');
            setupBtn('btn-left', 'left');
            setupBtn('btn-right', 'right');
        }
    </script>
</body>
</html>
